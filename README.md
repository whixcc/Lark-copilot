# 一、流程总览
自动化程序可以实现自动群里抓取前一天未闭店信息或近期到期隐患，并在相关群内推送，打开程序后需进行简单设置，请按下面流程操作
第5步配置Windows定时任务设置，可以让程序每天到时间自动运行，需注意运行参数和起始于参数设置
1. 下载自动化程序软件
2. 配置群组推送机器人
3. 三关一闭程序设置
4. 隐患提醒程序设置
5. 配置Windows定时任务

# 二、下载链接
详见release

# 三、配置群组推送机器人
## 1、配置流程
1. 飞书电脑端打开想推送信息的群，找到设置界面-群机器人选项
2. 点击啊添加机器人-添加自定义机器人
3. 自定义机器人名称可自行设置，如“工作提醒机器人”，机器人描述可简要编辑功能介绍
4. 点击添加后可看到图4界面，复制“webhook地址”并保存
## 2、常见问题
1. 能否只给单个员工推送消息？
  1. 可以，需要飞书单独开通权限
2. 不同的群需要添加不同的机器人吗？
  1. 是的，每个自定义机器人仅在本群组内生效

# 四、三关一闭程序设置
## 1、配置流程
1. 运行程序，点击设置进入配置页面
2. PIN码是统一登陆平台的密码，一般是6位数字
3. Webhook URL是上一步创建的群组机器人的地址，不同群组地址不一样，如果输入错了信息会推错群
4. 下载文件路径，就是每次用浏览器导出三关一闭未闭店店铺的路径，点击选择按钮选择即可
5. 默认浏览器一般电脑上用的是Firefox
6. 最后点击保存，关闭配置页面，点击运行即可自动运行
## 2、应用场景
本程序可提醒前一天未闭店店铺，一般用来次日8点、9点自动运行，提醒运营、物业同事督促前一天未完成闭店店铺完成闭店
## 3、常见问题
1. 输入了PIN码会不会泄密？
  1. 不会泄密，配置文件信息保存在软件的路径，config1文件里，只保存在本地
2. 能否自动@相关同事？
  1. 不同项目应用场景不一样，且人员变动频繁的话维护成本高，目前是@群内所有人

# 五、隐患提醒程序设置
## 1、配置流程
1. 运行程序，点击设置进入配置页面
2. PIN码是统一登陆平台的密码，一般是6位数字
3. Webhook URL是上一步创建的群组机器人的地址，不同群组地址不一样，如果输入错了信息会推错群
4. 下载文件夹是指日常使用系统时导出隐患清单的路径，这样才能自动获取下载的文件
5. 需项目人事导出一份花名册，按照图3的格式保留3列，序号、姓名、员工ID，配置界面选择此文件
6. 默认浏览器一般电脑上用的是Firefox
7. 最后点击保存，关闭配置页面，点击运行即可自动运行
## 2、应用场景
本程序可抓取7天前至今天隐患排查未整改、未审批完的隐患信息，同时根据导入的花名册信息，自动在相应的群里@责任人提醒
## 3、常见问题
1. 为什么需要花名册？
  1. 每个隐患可以自动@相关人员，需要从花名册中查找员工ID匹配
2. 花名册格式有要求吗？
  1. 是的，人行导出的花名册需要按照示例图简单修改，确保只包含3列，列名保持一致

# 六、配置Windows定时任务
1. 点击菜单栏搜索按钮，输入“taskschd”，点击即可配置计划任务，或者采用第二个图的方法，进入此电脑-C盘-Windows路径-System32文件夹，找到taskschd.msc程序，双击运行
2. 在计划任务界面，参照图3，先点击任务计划程序库，然后点击右侧创建任务
3. 设置任务名，可自行设置，下方选择不管用户是否登录都要运行
4. 在触发器中选择新增，设置自动运行时间和运行频率
5. 在操作选项卡中，点击浏览选中下载的程序，参数中输入--auto，起始于输入下载的程序所在路径
6. 其他设置参照最后一张图
7. 最后点击保存，会要求输入密码，此密码是电脑的登录密码，这样锁屏状态程序也可以自动运行
